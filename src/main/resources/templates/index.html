<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle}">Sistema Acad√™mico</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script th:inline="javascript">
        // Vari√°veis de Gr√°ficos Iniciais REMOVIDAS.
        
        window.frequenciaEstudoVsMedia = /*[[${frequenciaEstudoVsMedia}]]*/ [{}]; // Item 1
        window.estresseVsProjetos = /*[[${estresseVsProjetos}]]*/ [{}]; // Item 2
        window.suporteProfVsProjetos = /*[[${suporteProfVsProjetos}]]*/ [{}]; // Item 3
        window.frequenciaVsDisciplinas = /*[[${frequenciaVsDisciplinas}]]*/ [{}]; // Item 4
        window.valorVsMedia = /*[[${valorVsMedia}]]*/ [{}]; // Item 5
        window.distribuicaoEmail = /*[[${distribuicaoEmail}]]*/ [{}]; // Item 6
        window.distribuicaoGenero = /*[[${distribuicaoGenero}]]*/ [{}]; // Item 7
        window.distribuicaoTelefone = /*[[${distribuicaoTelefone}]]*/ [{}]; // Item 8
        window.distribuicaoProjetos = /*[[${distribuicaoProjetos}]]*/ [{}]; // Item 9
        window.distribuicaoFreqEstudo = /*[[${distribuicaoFreqEstudo}]]*/ [{}]; // Item 10
        window.distribuicaoIdadeGrafico = /*[[${distribuicaoIdadeGrafico}]]*/ [{}]; // Item 11 (Pizza)
        window.distribuicaoRecursos = /*[[${distribuicaoRecursos}]]*/ [{}]; // Item 12
        window.dadosMonitoria = /*[[${dadosMonitoria}]]*/ [{}]; // Item 13
        window.freqRecursosVsEstudo = /*[[${freqRecursosVsEstudo}]]*/ [{}]; // Item 14
    </script>
    </head>
<body>
    <header class="page-header">
    <h1>Sistema Acad√™mico</h1>
    </header>

<main class="layout">
    <section class="card">
        <h2>Comandos para Alunos</h2>
        
        
        <form class="form-grid" data-action="create-aluno">
            <h3>Criar Novo Aluno</h3>
            <label>
                Nome:
                <input type="text" name="nome" required>
            </label>
            <label>
                Data de Nascimento:
                <input type="date" name="dataNasc" required>
            </label>
            <label>
                Idade:
                <input type="number" name="idade" min="16" max="100" required>
            </label>
            <label>
                Sexo:
                <select name="sexo" required>
                    <option value="">Selecione</option>
                    <option value="M">Masculino</option>
                    <option value="F">Feminino</option>
                </select>
            </label>
            <label>
                Rua:
                <input type="text" name="rua">
            </label>
            <label>
                N√∫mero:
                <input type="number" name="num">
            </label>
            <label>
                CEP:
                <input type="text" name="cep" placeholder="00000-000">
            </label>
            <button type="submit">Criar Aluno</button>
        </form>

        
        <form class="form-grid" data-action="update-aluno">
            <h3>Atualizar Aluno</h3>
            <label>
                ID do Aluno:
                <input type="number" name="id" required>
            </label>
            <label>
                Nome:
                <input type="text" name="nome">
            </label>
            <label>
                Data de Nascimento:
                <input type="date" name="dataNasc">
            </label>
            <label>
                Idade:
                <input type="number" name="idade" min="16" max="100">
            </label>
            <label>
                Sexo:
                <select name="sexo">
                    <option value="">Selecione</option>
                    <option value="M">Masculino</option>
                    <option value="F">Feminino</option>
                </select>
            </label>
            <label>
                M√©dia:
                <input type="number" name="media" min="0" max="10" step="0.1">
            </label>
            <label>
                Frequ√™ncia:
                <input type="number" name="frequencia" min="0" max="100" step="0.1">
            </label>
            <label>
                Status de Pagamento:
                <select name="statusPagamento">
                    <option value="">Manter atual</option>
                    <option value="pendente">Pendente</option>
                    <option value="pago">Pago</option>
                </select>
            </label>
            <button type="submit">Atualizar Aluno</button>
        </form>

        
        <form class="form-grid" data-action="delete-aluno">
            <h3>Deletar Aluno</h3>
            <label>
                ID do Aluno:
                <input type="number" name="id" required>
            </label>
            <button type="submit" class="danger">Deletar Aluno</button>
        </form>
    </section>

    <section class="card">
        <h2>Comandos para Professores</h2>
        
        
        <form class="form-grid" data-action="create-professor">
            <h3>Criar Novo Professor</h3>
            <label>
                Nome:
                <input type="text" name="nome" required>
            </label>
            <label>
                CPF:
                <input type="text" name="cpf" placeholder="000.000.000-00">
            </label>
            <label>
                Rua:
                <input type="text" name="rua">
            </label>
            <label>
                N√∫mero:
                <input type="number" name="num">
            </label>
            <label>
                CEP:
                <input type="text" name="cep" placeholder="00000-000">
            </label>
            <button type="submit">Criar Professor</button>
        </form>

        
        <form class="form-grid" data-action="update-professor">
            <h3>Atualizar Professor</h3>
            <label>
                ID do Professor:
                <input type="number" name="id" required>
            </label>
            <label>
                Nome:
                <input type="text" name="nome">
            </label>
            <label>
                CPF:
                <input type="text" name="cpf" placeholder="000.000.000-00">
            </label>
            <label>
                Rua:
                <input type="text" name="rua">
            </label>
            <label>
                N√∫mero:
                <input type="number" name="num">
            </label>
            <label>
                CEP:
                <input type="text" name="cep" placeholder="00000-000">
            </label>
            <button type="submit">Atualizar Professor</button>
        </form>

        
        <form class="form-grid" data-action="delete-professor">
            <h3>Deletar Professor</h3>
            <label>
                ID do Professor:
                <input type="number" name="id" required>
            </label>
            <button type="submit" class="danger">Deletar Professor</button>
        </form>
    </section>

    <section class="card">
        <h2>Comandos para Disciplinas</h2>
        
        
        <form class="form-grid" data-action="create-disciplina">
            <h3>Criar Nova Disciplina</h3>
            <label>
                Nome:
                <input type="text" name="nome" required>
            </label>
            <label>
                Carga Hor√°ria:
                <input type="number" name="cargaHoraria" min="20" max="120" required>
            </label>
            <button type="submit">Criar Disciplina</button>
        </form>

        
        <form class="form-grid" data-action="update-disciplina">
            <h3>Atualizar Disciplina</h3>
            <label>
                ID da Disciplina:
                <input type="number" name="id" required>
            </label>
            <label>
                Nome:
                <input type="text" name="nome">
            </label>
            <label>
                Carga Hor√°ria:
                <input type="number" name="cargaHoraria" min="20" max="120">
            </label>
            <button type="submit">Atualizar Disciplina</button>
        </form>

        
        <form class="form-grid" data-action="delete-disciplina">
            <h3>Deletar Disciplina</h3>
            <label>
                ID da Disciplina:
                <input type="number" name="id" required>
            </label>
            <button type="submit" class="danger">Deletar Disciplina</button>
        </form>
    </section>

    <section class="card">
        <h2>Comandos para Avalia√ß√µes</h2>
        
        
        <form class="form-grid" data-action="create-avaliacao">
            <h3>Criar Nova Avalia√ß√£o</h3>
            <label>
                Valor (0-10):
                <input type="number" name="valor" min="0" max="10" step="0.1" required>
            </label>
            <label>
                Data:
                <input type="date" name="data" required>
            </label>
            <label>
                ID do Aluno:
                <input type="number" name="idAluno" required>
            </label>
            <label>
                ID da Disciplina:
                <input type="number" name="idDisc" required>
            </label>
            <button type="submit">Criar Avalia√ß√£o</button>
        </form>

        
        <form class="form-grid" data-action="update-avaliacao">
            <h3>Atualizar Avalia√ß√£o</h3>
            <label>
                ID da Avalia√ß√£o:
                <input type="number" name="id" required>
            </label>
            <label>
                Valor (0-10):
                <input type="number" name="valor" min="0" max="10" step="0.1">
            </label>
            <label>
                Data:
                <input type="date" name="data">
            </label>
            <label>
                ID do Aluno:
                <input type="number" name="idAluno">
            </label>
            <label>
                ID da Disciplina:
                <input type="number" name="idDisc">
            </label>
            <button type="submit">Atualizar Avalia√ß√£o</button>
        </form>

        <!-- Formul√°rio para Deletar Avalia√ß√£o -->
        <form class="form-grid" data-action="delete-avaliacao">
            <h3>Deletar Avalia√ß√£o</h3>
            <label>
                ID da Avalia√ß√£o:
                <input type="number" name="id" required>
            </label>
            <button type="submit" class="danger">Deletar Avalia√ß√£o</button>
        </form>
    </section>

    <section class="card">
        <h2>Configura√ß√£o do Banco</h2>
        <div class="form-grid">
            <h3>Inicializar Banco de Dados</h3>
            <p>Execute este comando para criar todas as tabelas necess√°rias:</p>
            <button onclick="criarTabelas()" class="consulta-btn">Criar Tabelas do Banco</button>
            <div id="resultado-criacao" style="margin-top: 1rem;"></div>
        </div>
        <div class="form-grid" style="margin-top: 2rem;">
            <h3>Inicializar Estruturas SQL Avan√ßadas</h3>
            <p>Execute este comando para criar √≠ndices, views, fun√ß√µes, procedimentos e triggers:</p>
            <button onclick="inicializarEstruturasAvancadas()" class="consulta-btn">Inicializar Estruturas Avan√ßadas</button>
            <div id="resultado-avancado" style="margin-top: 1rem;"></div>
        </div>
    </section>

    <section class="card card-wide">
        <h2>üîç Consultas SQL Avan√ßadas</h2>
        
        <div class="form-grid">
            <h3>Consultas</h3>
            <button onclick="consultarProfessoresSemOfertas()" class="consulta-btn">Professores sem Ofertas</button>
            <button onclick="consultarAlunosEProfessoresEmails()" class="consulta-btn">Alunos e Professores com Emails</button>
            <button onclick="consultarAlunosAcimaMedia()" class="consulta-btn">Alunos Acima da M√©dia</button>
            <button onclick="consultarAlunosTurmas2023()" class="consulta-btn">Alunos em Turmas de 2023</button>
            <div id="resultado-consultas" style="margin-top: 1rem;"></div>
        </div>
    </section>

    <section class="card card-wide">
        <h2>üìã Views</h2>
        
        <div class="form-grid">
            <h3>Detalhes Acad√™micos do Aluno</h3>
            <button onclick="consultarViewDetalhesAcademicos()" class="consulta-btn">Ver Todos os Alunos</button>
            <label>
                Buscar por ID do Aluno:
                <input type="number" id="idAlunoView" placeholder="ID do Aluno" style="width: 150px;">
                <button onclick="consultarViewDetalhesAcademicosPorId()" class="consulta-btn">Buscar</button>
            </label>
            <div id="resultado-view-aluno" style="margin-top: 1rem;"></div>
        </div>

        <div class="form-grid" style="margin-top: 2rem;">
            <h3>Perfil Completo do Professor</h3>
            <button onclick="consultarViewPerfilProfessor()" class="consulta-btn">Ver Todos os Professores</button>
            <label>
                Buscar por ID do Professor:
                <input type="number" id="idProfView" placeholder="ID do Professor" style="width: 150px;">
                <button onclick="consultarViewPerfilProfessorPorId()" class="consulta-btn">Buscar</button>
            </label>
            <div id="resultado-view-professor" style="margin-top: 1rem;"></div>
        </div>
    </section>

    <section class="card card-wide">
        <h2>‚öôÔ∏è Fun√ß√µes SQL</h2>
        
        <div class="form-grid">
            <h3>Situa√ß√£o do Aluno</h3>
            <label>
                ID do Aluno:
                <input type="number" id="idAlunoFuncao" placeholder="ID do Aluno" required>
                <button onclick="consultarSituacaoAluno()" class="consulta-btn">Consultar Situa√ß√£o</button>
            </label>
            <div id="resultado-funcao-situacao" style="margin-top: 1rem;"></div>
        </div>

        <div class="form-grid" style="margin-top: 2rem;">
            <h3>Calcular M√©dia de Turma</h3>
            <label>
                ID da Turma:
                <input type="number" id="idTurmaMedia" placeholder="ID da Turma" required>
                <button onclick="calcularMediaTurma()" class="consulta-btn">Calcular M√©dia</button>
            </label>
            <div id="resultado-media-turma" style="margin-top: 1rem;"></div>
        </div>

        <!-- Fun√ß√£o calcularMediaDisciplina removida conforme solicitado -->
    </section>

    <section class="card card-wide">
        <h2>üîÑ Procedimentos SQL</h2>
        
        <div class="form-grid">
            <h3>Atualizar Frequ√™ncia do Aluno</h3>
            <label>
                ID do Aluno:
                <input type="number" id="idAlunoProcedimento" placeholder="ID do Aluno" required>
            </label>
            <label>
                Nova Frequ√™ncia (0-100):
                <input type="number" id="frequenciaNova" placeholder="Frequ√™ncia" min="0" max="100" step="0.1" required>
            </label>
            <button onclick="atualizarFrequenciaAluno()" class="consulta-btn">Atualizar Frequ√™ncia</button>
            <div id="resultado-procedimento-frequencia" style="margin-top: 1rem;"></div>
        </div>

        <div class="form-grid" style="margin-top: 2rem;">
            <h3>Consultar Conselhos por Professor (Navega√ß√£o)</h3>
            <label>
                ID do Professor:
                <input type="number" id="idProfConselhos" placeholder="ID do Professor" style="width: 150px;">
                <button onclick="iniciarNavegacaoConselhos()" class="consulta-btn">Iniciar Navega√ß√£o</button>
            </label>
            <div id="resultado-procedimento-conselhos" style="margin-top: 1rem;"></div>
            <div id="navegacao-conselhos" style="margin-top: 1rem; display: none;">
                <button onclick="proximoConselho()" class="consulta-btn">Pr√≥ximo Conselho ‚Üí</button>
            </div>
        </div>
        
        <div class="form-grid" style="margin-top: 2rem;">
            <h3>Criar Conselho e Atribuir a Professor</h3>
            <label>
                ID do Professor:
                <input type="number" id="idProfConselho" placeholder="ID do Professor" required>
            </label>
            <label>
                Descri√ß√£o do Conselho:
                <input type="text" id="descricaoConselho" placeholder="Descri√ß√£o" required>
            </label>
            <label>
                Data (opcional, deixe vazio para data atual):
                <input type="date" id="dataConselho">
            </label>
            <button onclick="criarConselho()" class="consulta-btn">Criar e Atribuir Conselho</button>
            <div id="resultado-criar-conselho" style="margin-top: 1rem;"></div>
        </div>
    </section>

    <section class="card card-wide">
        <h2>üìù Logs e Auditoria</h2>
        
        <div class="form-grid">
            <h3>Log de Pagamentos</h3>
            <p>Visualize o hist√≥rico de pagamentos registrado automaticamente pelo trigger:</p>
            <button onclick="consultarLogPagamento()" class="consulta-btn">Ver Log de Pagamentos</button>
            <div id="resultado-log-pagamento" style="margin-top: 1rem;"></div>
        </div>
    </section>

    <section class="card card-wide">
        <h2>Estat√≠sticas do Sistema</h2>
        
        <div class="stats-grid" th:if="${estatisticas}">
            <div class="stat-card">
                <h3>Total de Alunos</h3>
                <p class="stat-number" th:text="${estatisticas.totalAlunos}">0</p>
            </div>
            <div class="stat-card">
                <h3>Total de Disciplinas</h3>
                <p class="stat-number" th:text="${estatisticas.totalDisciplinas}">0</p>
            </div>
            <div class="stat-card">
                <h3>M√©dia Geral</h3>
                <p class="stat-number" th:text="${#numbers.formatDecimal(estatisticas.mediaGeralNotas, 1, 2)}">0.0</p>
            </div>
            <div class="stat-card">
                <h3>Taxa de Aprova√ß√£o</h3>
                <p class="stat-number" th:text="${#numbers.formatDecimal(estatisticas.taxaAprovacao, 1, 2) + '%'}">0.0%</p>
            </div>
            <div class="stat-card">
                <h3>Freq. Baixa</h3>
                <p class="stat-number" th:text="${estatisticas.alunosFrequenciaBaixa}">0</p>
            </div>
        </div>


        <div class="graficos-section">
            <h3>üìä Gr√°ficos Estat√≠sticos (10 + 4 Pesquisa)</h3>
            
            <div class="charts-grid">
                
                <div class="chart-container"><h4>Desempenho vs. Esfor√ßo</h4><canvas id="mediaVsEstudoChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Estresse vs. Projetos</h4><canvas id="estresseVsProjetosChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Suporte Prof. vs. Projetos</h4><canvas id="suporteProfVsProjetosChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Frequ√™ncia vs. Disciplinas</h4><canvas id="frequenciaVsDisciplinasChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Valor vs. M√©dia Geral</h4><canvas id="valorVsMediaChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Recursos vs. Estudo</h4><canvas id="freqRecursosVsEstudoChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Distribui√ß√£o por G√™nero</h4><canvas id="generoChart" width="400" height="200"></canvas></div>
                
                </div>
        </div>

        <div class="consultas-section">
        </div>

        <div class="error-message" th:if="${erro}">
        </div>
    </section>
</main>

<footer class="page-footer">
    <small>Etapa 03 - primeira vers√£o: estrutura para integra√ß√£o JDBC e dashboard</small>
</footer>

<script src="/js/dashboard.js"></script>
</body>
</html>