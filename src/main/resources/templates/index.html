<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle}">Sistema Acad√™mico</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script th:inline="javascript">
        // Vari√°veis de Gr√°ficos Iniciais REMOVIDAS.
        
        window.frequenciaEstudoVsMedia = /*[[${frequenciaEstudoVsMedia}]]*/ [{}]; // Item 1
        window.estresseVsProjetos = /*[[${estresseVsProjetos}]]*/ [{}]; // Item 2
        window.suporteProfVsProjetos = /*[[${suporteProfVsProjetos}]]*/ [{}]; // Item 3
        window.frequenciaVsDisciplinas = /*[[${frequenciaVsDisciplinas}]]*/ [{}]; // Item 4
        window.valorVsMedia = /*[[${valorVsMedia}]]*/ [{}]; // Item 5
        window.distribuicaoEmail = /*[[${distribuicaoEmail}]]*/ [{}]; // Item 6
        window.distribuicaoGenero = /*[[${distribuicaoGenero}]]*/ [{}]; // Item 7
        window.distribuicaoTelefone = /*[[${distribuicaoTelefone}]]*/ [{}]; // Item 8
        window.distribuicaoProjetos = /*[[${distribuicaoProjetos}]]*/ [{}]; // Item 9
        window.distribuicaoFreqEstudo = /*[[${distribuicaoFreqEstudo}]]*/ [{}]; // Item 10
        window.distribuicaoIdadeGrafico = /*[[${distribuicaoIdadeGrafico}]]*/ [{}]; // Item 11 (Pizza)
        window.distribuicaoRecursos = /*[[${distribuicaoRecursos}]]*/ [{}]; // Item 12
        window.dadosMonitoria = /*[[${dadosMonitoria}]]*/ [{}]; // Item 13
        window.freqRecursosVsEstudo = /*[[${freqRecursosVsEstudo}]]*/ [{}]; // Item 14
    </script>
    </head>
<body>
    <header class="page-header">
        <h1>Sistema Acad√™mico</h1>
        <p>Primeira vers√£o do dashboard acad√™mico com integra√ß√£o MySQL</p>
    </header>

<main class="layout">
    <section class="card">
        <h2>Comandos para Alunos</h2>
        
        <!-- Formul√°rio para Criar Aluno -->
        <form class="form-grid" data-action="create-aluno">
            <h3>Criar Novo Aluno</h3>
            <label>
                Nome:
                <input type="text" name="nome" required>
            </label>
            <label>
                Idade:
                <input type="number" name="idade" min="16" max="100" required>
            </label>
            <label>
                Sexo:
                <select name="sexo" required>
                    <option value="">Selecione</option>
                    <option value="M">Masculino</option>
                    <option value="F">Feminino</option>
                </select>
            </label>
            <label>
                Rua:
                <input type="text" name="rua">
            </label>
            <label>
                N√∫mero:
                <input type="number" name="num">
            </label>
            <label>
                CEP:
                <input type="text" name="cep" placeholder="00000-000">
            </label>
            <button type="submit">Criar Aluno</button>
        </form>

        <!-- Formul√°rio para Atualizar Aluno -->
        <form class="form-grid" data-action="update-aluno">
            <h3>Atualizar Aluno</h3>
            <label>
                ID do Aluno:
                <input type="number" name="id" required>
            </label>
            <label>
                Nome:
                <input type="text" name="nome">
            </label>
            <label>
                Idade:
                <input type="number" name="idade" min="16" max="100">
            </label>
            <label>
                Sexo:
                <select name="sexo">
                    <option value="">Selecione</option>
                    <option value="M">Masculino</option>
                    <option value="F">Feminino</option>
                </select>
            </label>
            <label>
                M√©dia:
                <input type="number" name="media" min="0" max="10" step="0.1">
            </label>
            <label>
                Frequ√™ncia:
                <input type="number" name="frequencia" min="0" max="100" step="0.1">
            </label>
            <button type="submit">Atualizar Aluno</button>
        </form>

        <!-- Formul√°rio para Deletar Aluno -->
        <form class="form-grid" data-action="delete-aluno">
            <h3>Deletar Aluno</h3>
            <label>
                ID do Aluno:
                <input type="number" name="id" required>
            </label>
            <button type="submit" class="danger">Deletar Aluno</button>
        </form>
    </section>

    <section class="card">
        <h2>Comandos para Disciplinas</h2>
        
        <!-- Formul√°rio para Criar Disciplina -->
        <form class="form-grid" data-action="create-disciplina">
            <h3>Criar Nova Disciplina</h3>
            <label>
                Nome:
                <input type="text" name="nome" required>
            </label>
            <label>
                Carga Hor√°ria:
                <input type="number" name="cargaHoraria" min="20" max="120" required>
            </label>
            <label>
                ID do Aluno:
                <input type="number" name="idAluno">
            </label>
            <label>
                ID da Turma:
                <input type="number" name="idTurma">
            </label>
            <button type="submit">Criar Disciplina</button>
        </form>

        <!-- Formul√°rio para Atualizar Disciplina -->
        <form class="form-grid" data-action="update-disciplina">
            <h3>Atualizar Disciplina</h3>
            <label>
                ID da Disciplina:
                <input type="number" name="id" required>
            </label>
            <label>
                Nome:
                <input type="text" name="nome">
            </label>
            <label>
                Carga Hor√°ria:
                <input type="number" name="cargaHoraria" min="20" max="120">
            </label>
            <button type="submit">Atualizar Disciplina</button>
        </form>

        <!-- Formul√°rio para Deletar Disciplina -->
        <form class="form-grid" data-action="delete-disciplina">
            <h3>Deletar Disciplina</h3>
            <label>
                ID da Disciplina:
                <input type="number" name="id" required>
            </label>
            <button type="submit" class="danger">Deletar Disciplina</button>
        </form>
    </section>

    <section class="card">
        <h2>Configura√ß√£o do Banco</h2>
        <div class="form-grid">
            <h3>Inicializar Banco de Dados</h3>
            <p>Execute este comando para criar todas as tabelas necess√°rias:</p>
            <button onclick="criarTabelas()" class="consulta-btn">Criar Tabelas do Banco</button>
            <div id="resultado-criacao" style="margin-top: 1rem;"></div>
        </div>
    </section>

    <section class="card card-wide">
        <h2>Estat√≠sticas do Sistema</h2>
        
        <div class="stats-grid" th:if="${estatisticas}">
            <div class="stat-card">
                <h3>Total de Alunos</h3>
                <p class="stat-number" th:text="${estatisticas.totalAlunos}">0</p>
            </div>
            <div class="stat-card">
                <h3>Total de Disciplinas</h3>
                <p class="stat-number" th:text="${estatisticas.totalDisciplinas}">0</p>
            </div>
            <div class="stat-card">
                <h3>M√©dia Geral</h3>
                <p class="stat-number" th:text="${#numbers.formatDecimal(estatisticas.mediaGeralNotas, 1, 2)}">0.0</p>
            </div>
            <div class="stat-card">
                <h3>Taxa de Aprova√ß√£o</h3>
                <p class="stat-number" th:text="${#numbers.formatDecimal(estatisticas.taxaAprovacao, 1, 2)}%">0.0%</p>
            </div>
            <div class="stat-card">
                <h3>Freq. Baixa</h3>
                <p class="stat-number" th:text="${estatisticas.alunosFrequenciaBaixa}">0</p>
            </div>
        </div>

        <ul class="consulta-list">
            <li th:each="consulta : ${consultas}" th:text="consulta">Consulta exemplo</li>
        </ul>

        <div class="graficos-placeholder" th:if="${estatisticas}">
            <h3 style="margin-top: 1.5rem;">Visualiza√ß√£o de Dados em Tabela</h3>
             <p>As tabelas iniciais foram removidas. Adicione seu c√≥digo de tabela aqui.</p>
        </div>

        <div class="graficos-section">
            <h3>üìä Gr√°ficos Estat√≠sticos (10 + 4 Pesquisa)</h3>
            
            <div class="charts-grid">
                
                <div class="chart-container"><h4>Desempenho vs. Esfor√ßo (Item 1)</h4><canvas id="mediaVsEstudoChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Estresse vs. Projetos (Item 2)</h4><canvas id="estresseVsProjetosChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Suporte Prof. vs. Projetos (Item 3)</h4><canvas id="suporteProfVsProjetosChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Frequ√™ncia vs. Disciplinas (Item 4)</h4><canvas id="frequenciaVsDisciplinasChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Valor vs. M√©dia Geral (Item 5)</h4><canvas id="valorVsMediaChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Distribui√ß√£o de Idade (Espec√≠fica) (Item 11)</h4><canvas id="idadeEspec√≠ficaChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Uso de Recursos (Contagem) (Item 12)</h4><canvas id="recursosChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Situa√ß√£o de Monitoria (Item 13)</h4><canvas id="monitoriaChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Recursos vs. Estudo (G√™nero) (Item 14)</h4><canvas id="freqRecursosVsEstudoChart" width="400" height="200"></canvas></div>
                <div class="chart-container"><h4>Distribui√ß√£o por G√™nero (Barra) (Item 7)</h4><canvas id="generoChart" width="400" height="200"></canvas></div>
                
                </div>
        </div>

        <div class="consultas-section">
        </div>

        <div class="error-message" th:if="${erro}">
        </div>
    </section>
</main>

<footer class="page-footer">
    <small>Etapa 03 - primeira vers√£o: estrutura para integra√ß√£o JDBC e dashboard</small>
</footer>

<script src="/js/dashboard.js"></script>
</body>
</html>